---
# Superset role defaults
# User-configurable settings are in inventory.yaml

# Helm configuration
superset_helm_repo_name: superset
superset_helm_repo_url: https://apache.github.io/superset
superset_helm_chart_name: superset
superset_helm_timeout: 15m

# Custom Superset image (override from inventory for CI/CD)
superset_image_repository: ghcr.io/washu-tag/superset
superset_image_tag: 5.0.0

# Redis session storage and caching configuration
superset_redis_database_name: superset-cache
superset_redis_database_port: 10001
superset_redis_memory_size: 1GB
superset_redis_persistence_enabled: true
# superset_redis_password: defined in inventory.yaml (use vault encryption)

# Branding
superset_app_name: Scout Analytics
superset_logo_width: 200

# SQL Alchemy pool settings
# Pool size maintains persistent connections, overflow allows burst capacity
# Total max connections = pool_size + pool_max_overflow
# We've set the pool size based on an estimated number of users who can simultaneously load the main scout dashboard (~10 widgets)
# 30 persistent connections = 3 users
# 60 total connections = 6 users
# If more than 6 users try to load the main dashboard at the same moment, they may experience delays
#  or "Data error: Bad gateway" messages. But a refresh will clear that up.
# We don't want the total number of connections to get so high it has effects on trino, but we don't know
#  trino's max capacity.
superset_pool_size: 30
superset_pool_max_overflow: 30
superset_pool_timeout: 60

# PostgreSQL configuration
superset_postgres_user: superset
superset_postgres_password: changeme
superset_database: superset

# Analytics directory path
superset_analytics_dir: '{{ scout_repo_dir }}/analytics/superset'

# Scout logo and favicon paths
superset_logo_path: '{{ scout_repo_dir }}/launchpad/public/scout.png'
superset_favicon_path: '{{ scout_repo_dir }}/launchpad/public/favicon.ico'

# Resource configuration (dev defaults - CI friendly)
superset_resources:
  requests:
    cpu: 250m
    memory: 1Gi
  limits:
    cpu: 2
    memory: 2Gi

# StatsD Exporter configuration for Prometheus metrics
# The statsd-exporter runs as a sidecar to collect Superset application metrics
superset_statsd_exporter_image: prom/statsd-exporter
# superset_statsd_exporter_tag: defined in group_vars/all/versions.yaml
superset_statsd_port: 9125 # UDP port for StatsD metrics from Superset
superset_statsd_metrics_port: 9102 # HTTP port for Prometheus scraping
superset_statsd_prefix: superset # Prefix for all StatsD metrics
superset_statsd_resources:
  requests:
    cpu: 50m
    memory: 64Mi
  limits:
    cpu: 200m
    memory: 128Mi
