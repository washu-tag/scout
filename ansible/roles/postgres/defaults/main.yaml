---
# Dev-friendly defaults for postgres role
# These are overridden by group_vars/k3s_cluster/postgres.yaml in production

# Postgres storage configuration
postgres_storage_size: 1Gi
postgres_resources: {}
postgres_parameters:
  max_connections: '100'
  shared_buffers: '256MB'
  effective_cache_size: '1GB'
  maintenance_work_mem: '64MB'
  checkpoint_completion_target: '0.9'
  wal_buffers: '4MB'
  default_statistics_target: '100'
  random_page_cost: '4'
  effective_io_concurrency: '1'
  work_mem: '4MB'
  huge_pages: 'try'
  min_wal_size: '1GB'
  max_wal_size: '4GB'
  max_worker_processes: '4'
  max_parallel_workers_per_gather: '2'
  max_parallel_workers: '4'
  max_parallel_maintenance_workers: '2'

# Storage naming
postgres_name: postgres
postgres_storage_class: '{{ postgres_name }}-storage'

# Storage definitions for persistent volumes
# Using service-specific name to avoid conflicts when multiple services define storage
postgres_storage_definitions:
  - name: '{{ postgres_name }}'
    size: '{{ postgres_storage_size }}'
    path: '{{ postgres_dir }}'
    pv_name: '{{ postgres_name }}-pv'
    storage_class_name: '{{ postgres_storage_class }}'
