---
# Pull Ollama models - selects appropriate method based on deployment mode
#
# Modes:
#   - Online (air_gapped: false): Pull directly from registry.ollama.ai
#   - Air-gapped with NFS: Pull to shared NFS from staging, production mounts read-only
#   - Air-gapped without NFS: Pull on staging, transfer via kubectl cp

# Online: pull directly from registry (current behavior)
- name: Pull models via Job (online)
  ansible.builtin.include_tasks: pull_models_online.yaml
  when: not (air_gapped | default(false) | bool)

# Air-gapped with NFS: pull to NFS on staging
- name: Pull models to NFS from staging
  ansible.builtin.include_tasks: pull_models_nfs.yaml
  when:
    - air_gapped | default(false) | bool
    - ollama_nfs_path is defined
    - ollama_nfs_path | length > 0

# Air-gapped without NFS: pull on staging, transfer via kubectl cp
- name: Pull and transfer models from staging
  ansible.builtin.include_tasks: pull_models_transfer.yaml
  when:
    - air_gapped | default(false) | bool
    - ollama_nfs_path is not defined or ollama_nfs_path | length == 0
