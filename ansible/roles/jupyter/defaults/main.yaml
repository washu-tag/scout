---
# Jupyter role defaults
# User-configurable settings are in inventory.yaml

# Namespace
jupyter_namespace: jupyter

# Helm configuration
jupyter_helm_repo_name: jupyterhub
jupyter_helm_repo_url: https://raw.githubusercontent.com/jupyterhub/helm-chart/refs/heads/gh-pages/
jupyter_helm_chart_name: jupyterhub

# Storage configuration
jupyter_hub_name: jupyter-hub
jupyter_hub_storage_class: '{{ jupyter_hub_name }}-storage'
jupyter_hub_storage_size: 1Gi

jupyter_singleuser_name: jupyter-singleuser
jupyter_singleuser_storage_class: '{{ jupyter_singleuser_name }}-storage'
jupyter_singleuser_storage_size: 10Gi
jupyter_singleuser_pvc: '{{ jupyter_singleuser_name }}-pvc'

# Storage definitions
jupyter_storage_definitions:
  - name: '{{ jupyter_hub_name }}'
    size: '{{ jupyter_hub_storage_size }}'
    path: '{{ jupyter_dir }}/hub'
    pv_name: '{{ jupyter_hub_name }}-pv'
    storage_class_name: '{{ jupyter_hub_storage_class }}'
  - name: '{{ jupyter_singleuser_name }}'
    size: '{{ jupyter_singleuser_storage_size }}'
    path: '{{ jupyter_dir }}/singleuser'
    pv_name: '{{ jupyter_singleuser_name }}-pv'
    storage_class_name: '{{ jupyter_singleuser_storage_class }}'

# Single-user image configuration
jupyter_singleuser_image_name: ghcr.io/washu-tag/pyspark-notebook
jupyter_singleuser_image_tag: 1.1.0

# API tokens for JupyterHub services
# REQUIRED: Must be set in inventory.yaml (use vault encryption)
# Example: openssl rand -hex 32 | ansible-vault encrypt_string --vault-password-file vault/pwd.sh
jupyter_metrics_api_token: ''

# PrePuller configuration
jupyter_prepuller_continuous: false

# Jupyter resources
jupyter_hub_resources:
  requests:
    cpu: 100m
    memory: 256M
  limits:
    cpu: 500m
    memory: 512M
jupyter_cpu_profile:
  display_name: 'CPU Only'
  slug: 'cpu'
  description: 'CPU only environment for data analysis'
  default: true
  profile_options:
    resource_allocation:
      display_name: 'Size'
      choices:
        small:
          display_name: 'Small (1 CPU, 4Gi RAM)'
          kubespawner_override:
            cpu_guarantee: 0.5
            cpu_limit: 1
            mem_guarantee: '1G'
            mem_limit: '4G'
            environment:
              SPARK_DRIVER_MEMORY: '3g'
              SPARK_EXECUTOR_MEMORY: '3g'
        medium:
          display_name: 'Medium (2 CPU, 8Gi RAM)'
          kubespawner_override:
            cpu_guarantee: 1
            cpu_limit: 2
            mem_guarantee: '2G'
            mem_limit: '8G'
            environment:
              SPARK_DRIVER_MEMORY: '6g'
              SPARK_EXECUTOR_MEMORY: '6g'
        large:
          display_name: 'Large (4 CPU, 16Gi RAM)'
          default: true
          kubespawner_override:
            cpu_guarantee: 2
            cpu_limit: 4
            mem_guarantee: '4G'
            mem_limit: '16G'
            environment:
              SPARK_DRIVER_MEMORY: '12g'
              SPARK_EXECUTOR_MEMORY: '12g'
jupyter_profiles:
  - '{{ jupyter_cpu_profile }}'
