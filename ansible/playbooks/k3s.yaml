---
# K3s Installation Playbook
# Installs k3s on server and agent nodes
# Supports both online and air-gapped deployment modes
#
# Documentation:
#   - Inventory configuration: docs/source/technical/inventory.md
#   - Air-gapped deployment: docs/source/technical/air-gapped.md
#   - Role details: ansible/roles/k3s/README.md

- name: Install Python kubernetes library on cluster nodes
  hosts: k3s_cluster
  roles:
    - role: python-kubernetes

- name: Install k3s cluster
  hosts: k3s_cluster
  environment: "{{ k8s_environment }}"
  roles:
    - role: scout_common
    - role: k3s

- name: Configure custom storage classes
  hosts: server
  environment: "{{ k8s_environment }}"
  roles:
    - role: scout_common
      tasks_from: storage_classes
