- name: Populate PACS via C-STORE
  kubernetes.core.k8s:
    state: present
    definition:
      apiVersion: batch/v1
      kind: Job
      metadata:
        name: 'pacs-populate-{{ 9999999999 | random | to_uuid }}'
        namespace: '{{ namespace }}'
        labels:
          app: pacs-populate
      spec:
        ttlSecondsAfterFinished: 600
        backoffLimit: 3
        template:
          metadata:
            labels:
              app: pacs-populate
          spec:
            restartPolicy: Never
            containers:
              - name: dcmtk
                image: vanessa/dicom
                command:
                  - sleep
                  - 300s
                volumeMounts:
                  - name: data
                    mountPath: /data
                    readOnly: true
            volumes:
              - name: data
                hostPath:
                  path: "{{ data_dir }}"