---
- name: Create storage directories for Harbor
  hosts: staging
  gather_facts: false
  tasks:
    - name: Create storage directories
      ansible.builtin.include_role:
        name: harbor
        tasks_from: storage

- name: Deploy Harbor
  hosts: staging
  gather_facts: false
  environment:
    KUBECONFIG: '{{ kubeconfig_yaml }}'
    K8S_AUTH_KUBECONFIG: '{{ kubeconfig_yaml }}'
  roles:
    - harbor
