{
  "viewName": "%TABLE_PLACEHOLDER%",
  "testQueries": [
    {
      "expectedQueryResult": {
        "type": ".ExactNumberObjectsResult",
        "expectedNumResults": 34,
        "additionalValidation": {
          "type": ".FixedColumnsValidator",
          "fixedColumns": {
            "sex": ["F"]
          }
        }
      },
      "sql": "SELECT * FROM %TABLE_PLACEHOLDER% WHERE sex='F'",
      "id": "sex_equals"
    },
    {
      "expectedQueryResult": {
        "type": ".ExactNumberObjectsResult",
        "expectedNumResults": 31,
        "additionalValidation": {
          "type": ".FixedColumnsValidator",
          "fixedColumns": {
            "study_instance_uid": [null],
            "version_id": ["2.3", "2.4"]
          }
        }
      },
      "sql": "SELECT * FROM %TABLE_PLACEHOLDER% WHERE study_instance_uid IS NULL",
      "id": "uid_missing"
    },
    {
      "expectedQueryResult": {
        "type": ".ExactNumberObjectsResult",
        "expectedNumResults": 8,
        "additionalValidation": {
          "type": ".DateComparisonValidation",
          "description": "patient born after 1990-12-31",
          "columnName": "birth_date",
          "comparisonValue": 19901231,
          "comparisonOperator": "GT"
        }
      },
      "sql": "SELECT * FROM %TABLE_PLACEHOLDER% WHERE YEAR(birth_date) > 1990",
      "id": "dob_greater"
    },
    {
      "expectedQueryResult": {
        "type": ".ExactNumberObjectsResult",
        "expectedNumResults": 22,
        "additionalValidation": {
          "type": ".FixedColumnsValidator",
          "fixedColumns": {
            "orc_2_placer_order_number": [null],
            "version_id": ["2.4"]
          }
        }
      },
      "sql": "SELECT * FROM %TABLE_PLACEHOLDER% WHERE orc_2_placer_order_number IS NULL",
      "id": "placer_order_missing"
    },
    {
      "expectedQueryResult": {
        "type": ".ExactNumberObjectsResult",
        "expectedNumResults": 9,
        "additionalValidation": {
          "type": ".FixedColumnsValidator",
          "fixedColumns": {
            "sex": ["F"],
            "race": ["B", "BLACK"]
          }
        }
      },
      "sql": "SELECT * FROM %TABLE_PLACEHOLDER% WHERE sex='F' AND race IN ('BLACK', 'B')",
      "id": "sex_and_race_list_inclusion"
    },
    {
      "expectedQueryResult": {
        "type": ".GroupedAggregationResult",
        "result": {
          "IR": {
            "male_count": 2,
            "female_count": 2,
            "total_count": 4
          },
          "US": {
            "male_count": 4,
            "female_count": 1,
            "total_count": 5
          },
          "XR": {
            "male_count": 13,
            "female_count": 10,
            "total_count": 23
          },
          "MG": {
            "male_count": 0,
            "female_count": 12,
            "total_count": 12
          },
          "": {
            "male_count": 1,
            "female_count": 4,
            "total_count": 5
          },
          "PET": {
            "male_count": 1,
            "female_count": 1,
            "total_count": 2
          },
          "NM": {
            "male_count": 4,
            "female_count": 1,
            "total_count": 5
          },
          "MR": {
            "male_count": 1,
            "female_count": 3,
            "total_count": 4
          }
        },
        "primaryColumnName": "primary_modality",
        "secondaryColumns": ["male_count", "female_count", "total_count"]
      },
      "sql": "SELECT modality as primary_modality, COUNT(CASE WHEN sex='M' THEN 1 END) as male_count, COUNT(CASE WHEN sex='F' THEN 1 END) as female_count, COUNT(*) as total_count FROM %TABLE_PLACEHOLDER% GROUP BY modality ORDER BY modality",
      "id": "modality_grouping"
    },
    {
      "expectedQueryResult": {
        "type": ".GroupedAggregationResult",
        "result": {
          "": {
            "total_count": 8
          },
          "F": {
            "total_count": 11
          },
          "Wet Read": {
            "total_count": 6
          },
          "Prelim": {
            "total_count": 11
          },
          "Final": {
            "total_count": 17
          },
          "P": {
            "total_count": 7
          }
        },
        "primaryColumnName": "report_status",
        "secondaryColumns": ["total_count"]
      },
      "sql": "SELECT report_status, COUNT(*) as total_count FROM %TABLE_PLACEHOLDER% GROUP BY report_status ORDER BY report_status",
      "id": "report_status_count"
    },
    {
      "expectedQueryResult": {
        "type": ".ExactRowsResult",
        "uniqueIdColumnName": "message_control_id",
        "rowAssertions": {
          "2.25.204398915138762988851874407954207601533": {
            "version_id": "2.3",
            "mpi": "6419351",
            "sending_facility": "ABCHOSP",
            "service_identifier": "IMG154",
            "sex": "M",
            "zip_or_postal_code": "61111",
            "country": "",
            "orc_2_placer_order_number": "",
            "obr_2_placer_order_number": "3480069",
            "patient_age": null,
            "principal_result_interpreter": "MEGAN FLORES",
            "assistant_result_interpreter": "[]",
            "technician": "[HOLLY BARRY]",
            "orc_3_filler_order_number": "",
            "obr_3_filler_order_number": "800257419",
            "service_name": "XR ABDOMEN AP 1 VIEW",
            "service_coding_system": null,
            "diagnostic_service_id": "",
            "study_instance_uid": null,
            "birth_date": "1992-01-10",
            "message_dt": "2025-08-14T12:56:21+00:00",
            "requested_dt": null,
            "results_report_status_change_dt": "2025-08-14T12:56:21+00:00",
            "year": "2025"
          },
          "2.25.121043577106706659500131090336553354531": {
            "version_id": "2.4",
            "mpi": null,
            "sending_facility": "ABCHOSP",
            "service_identifier": "IMG154",
            "sex": "F",
            "zip_or_postal_code": "61111",
            "country": "USA",
            "orc_2_placer_order_number": null,
            "obr_2_placer_order_number": "5539751",
            "patient_age": null,
            "principal_result_interpreter": "JACQUELINE BISHOP",
            "assistant_result_interpreter": "[LUIS SMALL]",
            "technician": "[]",
            "orc_3_filler_order_number": null,
            "obr_3_filler_order_number": "800257423",
            "service_name": "XR ABDOMEN AP 1 VIEW",
            "service_coding_system": "UNKDEV",
            "diagnostic_service_id": "IMG",
            "study_instance_uid": null,
            "birth_date": "1958-08-09",
            "message_dt": "2025-08-14T19:05:25+00:00",
            "requested_dt": null,
            "results_report_status_change_dt": "2025-08-14T19:05:25+00:00",
            "year": "2025"
          },
          "2.25.203807271003801336156822674911037502972": {
            "version_id": "2.7",
            "mpi": null,
            "sending_facility": "ABCHOSP",
            "service_identifier": "IMG4185",
            "sex": "F",
            "zip_or_postal_code": "61111",
            "country": "USA",
            "orc_2_placer_order_number": "5185399",
            "obr_2_placer_order_number": "5185399",
            "patient_age": "63",
            "principal_result_interpreter": null,
            "assistant_result_interpreter": "[LUIS SMALL]",
            "technician": "[JASON WEBB]",
            "orc_3_filler_order_number": "800257430",
            "obr_3_filler_order_number": "800257430",
            "service_name": "IR INTRO CATHETER AORTA BILATERAL",
            "service_coding_system": "UNKDEV",
            "diagnostic_service_id": "XA",
            "study_instance_uid": "2.25.314490230937939957455802523623947719892",
            "birth_date": "1962-01-20",
            "message_dt": "2025-08-14T12:18:32+00:00",
            "requested_dt": "2025-08-14T10:30:00+00:00",
            "results_report_status_change_dt": "2025-08-14T12:18:32+00:00",
            "year": "2025"
          }
        },
        "columnTypes": [
          {
            "type": ".LocalDateType",
            "columnName": "birth_date"
          },
          {
            "type": ".InstantType",
            "columnName": "message_dt"
          },
          {
            "type": ".InstantType",
            "columnName": "requested_dt"
          },
          {
            "type": ".InstantType",
            "columnName": "results_report_status_change_dt"
          },
          {
            "type": ".IntegerType",
            "columnName": "year"
          },
          {
            "type": ".IntegerType",
            "columnName": "patient_age"
          },
          {
            "type": ".ArrayType",
            "columnName": "assistant_result_interpreter"
          },
          {
            "type": ".ArrayType",
            "columnName": "technician"
          }
        ]
      },
      "sql": "SELECT * FROM %TABLE_PLACEHOLDER% WHERE message_control_id IN ('2.25.204398915138762988851874407954207601533', '2.25.121043577106706659500131090336553354531', '2.25.203807271003801336156822674911037502972')",
      "id": "extended_metadata"
    },
    {
      "expectedQueryResult": {
        "type": ".ExactRowsResult",
        "uniqueIdColumnName": "message_control_id",
        "rowAssertions": {
          "2.25.219548451968858381851753454287567971428": {
            "abc_mr": "ABC1538608",
            "epic_mrn": "EPIC2056919",
            "legacy_patient_id_un": null,
            "empi_mr": "6419351",
            "patient_ids": "[[ABC1538608,ABC,MR,], [EPIC2056919,EPIC,MRN,], [6419351,EMPI,MR,]]"
          },
          "2.25.61155004502365997902991606362324782931": {
            "abc_mr": "ABC1538608",
            "epic_mrn": "EPIC2056919",
            "legacy_patient_id_un": null,
            "empi_mr": null,
            "patient_ids": "[[ABC1538608,ABC,MR,], [EPIC2056919,EPIC,MRN,]]"
          },
          "2.25.204398915138762988851874407954207601533": {
            "abc_mr": null,
            "epic_mrn": null,
            "legacy_patient_id_un": "8540367",
            "empi_mr": null,
            "patient_ids": "[[8540367,,,UN]]"
          },
          "2.25.328973252536500389074993126308062841002": {
            "abc_mr": "ABC1538609",
            "epic_mrn": "EPIC2056920",
            "legacy_patient_id_un": null,
            "empi_mr": null,
            "patient_ids": "[[ABC1538609,ABC,MR,], [EPIC2056920,EPIC,MRN,]]"
          },
          "2.25.188036692001324128072425296115844067182": {
            "abc_mr": "ABC1538609",
            "epic_mrn": "EPIC2056920",
            "legacy_patient_id_un": null,
            "empi_mr": null,
            "patient_ids": "[[ABC1538609,ABC,MR,], [EPIC2056920,EPIC,MRN,]]"
          },
          "2.25.37795153549849511405749573418478407533": {
            "abc_mr": "ABC1538609",
            "epic_mrn": "EPIC2056920",
            "legacy_patient_id_un": null,
            "empi_mr": null,
            "patient_ids": "[[ABC1538609,ABC,MR,], [EPIC2056920,EPIC,MRN,]]"
          },
          "2.25.121043577106706659500131090336553354531": {
            "abc_mr": "ABC1538610",
            "epic_mrn": "EPIC2056921",
            "legacy_patient_id_un": null,
            "empi_mr": null,
            "patient_ids": "[[ABC1538610,ABC,MR,], [EPIC2056921,EPIC,MRN,]]"
          },
          "2.25.102637249815259293738918189168983894057": {
            "abc_mr": "ABC1538611",
            "epic_mrn": "EPIC2056922",
            "legacy_patient_id_un": null,
            "empi_mr": null,
            "patient_ids": "[[ABC1538611,ABC,MR,], [EPIC2056922,EPIC,MRN,]]"
          },
          "2.25.106740314803027468744708885437152926967": {
            "abc_mr": "ABC1538611",
            "epic_mrn": "EPIC2056922",
            "legacy_patient_id_un": null,
            "empi_mr": null,
            "patient_ids": "[[ABC1538611,ABC,MR,], [EPIC2056922,EPIC,MRN,]]"
          },
          "2.25.141708643737957297303047458699896564028": {
            "abc_mr": "ABC1538611",
            "epic_mrn": "EPIC2056922",
            "legacy_patient_id_un": null,
            "empi_mr": null,
            "patient_ids": "[[ABC1538611,ABC,MR,], [EPIC2056922,EPIC,MRN,]]"
          },
          "2.25.239806527677042120944431850418213781171": {
            "abc_mr": "ABC1538611",
            "epic_mrn": "EPIC2056922",
            "legacy_patient_id_un": null,
            "empi_mr": null,
            "patient_ids": "[[ABC1538611,ABC,MR,], [EPIC2056922,EPIC,MRN,]]"
          },
          "2.25.201339583218469953996551461947620745895": {
            "abc_mr": "ABC1538612",
            "epic_mrn": "EPIC2056923",
            "legacy_patient_id_un": null,
            "empi_mr": null,
            "patient_ids": "[[ABC1538612,ABC,MR,], [EPIC2056923,EPIC,MRN,]]"
          },
          "2.25.292146506290779935026264127891051142916": {
            "abc_mr": null,
            "epic_mrn": null,
            "legacy_patient_id_un": "8540371",
            "empi_mr": null,
            "patient_ids": "[[8540371,,,UN]]"
          },
          "2.25.203807271003801336156822674911037502972": {
            "abc_mr": "ABC1538612",
            "epic_mrn": "EPIC2056923",
            "legacy_patient_id_un": null,
            "empi_mr": "6419355",
            "patient_ids": "[[ABC1538612,ABC,MR,], [EPIC2056923,EPIC,MRN,], [6419355,EMPI,MR,]]"
          }
        },
        "columnTypes": [
          {
            "type": ".ArrayType",
            "columnName": "patient_ids"
          }
        ]
      },
      "sql": "SELECT * FROM %TABLE_PLACEHOLDER% WHERE (abc_mr IN ('ABC1538608', 'ABC1538608', 'ABC1538609', 'ABC1538609', 'ABC1538609', 'ABC1538610', 'ABC1538611', 'ABC1538611', 'ABC1538611', 'ABC1538611', 'ABC1538612', 'ABC1538612') OR legacy_patient_id_un IN ('8540367', '8540371'))",
      "id": "patient_id"
    },
    {
      "expectedQueryResult": {
        "type": ".ExactNumberObjectsResult",
        "expectedNumResults": 60,
        "additionalValidation": null
      },
      "sql": "SELECT * FROM %TABLE_PLACEHOLDER%",
      "id": "all"
    },
    {
      "expectedQueryResult": {
        "type": ".ExactNumberObjectsResult",
        "expectedNumResults": 0,
        "additionalValidation": null
      },
      "sql": "SELECT * FROM %TABLE_PLACEHOLDER% WHERE message_dt IS NULL",
      "id": "null_message_dt"
    },
    {
      "expectedQueryResult": {
        "type": ".ExactRowsResult",
        "uniqueIdColumnName": "message_control_id",
        "rowAssertions": {
          "2.25.61155004502365997902991606362324782931": {
            "report_text": "MICHAEL WINTERS, M.D.\n\n\n\n********FINAL REPORT********\n\n\n \nACC#  Date Time  Exam\n\n\n800257418 Aug 14 2025 12:51PM IMG2816 US ABDOMEN LIMITED\nEXAMINATION: Abdominal and pelvic ultrasound\n\nFINDINGS:\nInserted statement for testing with special chars: ±60%÷\nUltrasound reveals moderate bilateral hydronephrosis. The kidney\nparenchyma shows maintained cortical thickness and echogenicity. No\nobvious obstructing calculi visualized in the renal pelvis or\nureters. Bladder appears partially filled, without masses or\nsignificant wall thickening.\n\n\nIMPRESSION:\nModerate bilateral hydronephrosis likely secondary to obstructive\nuropathy. No clear cause identified sonographically. Suggest further\nurologic evaluation and correlation.\nRequested By: Small,Luis P. M.D.\n\nDictated By: Michael Winters, M.D. on Aug 14 2025 12:51PM\n\nThis document has been electronically signed by: Michael Winters,\nM.D. on Aug 14 2025 12:51PM\n \n\n\n \n\n\n \n800257418^UK^ZB"
          },
          "2.25.204398915138762988851874407954207601533": {
            "report_text": "EXAMINATION: Abdominal radiography\nFINDINGS:\nThe abdominal X-ray demonstrates mildly dilated loops of small bowel\nwith air-fluid levels, suggestive of early small bowel obstruction.\nThere is no free intraperitoneal air identified. Soft tissue and bony\nstructures appear within normal limits. No abnormal calcifications or\nforeign bodies noted.\n\n\nIMPRESSION:\nFindings consistent with early small bowel obstruction without\nevidence of perforation. Recommend clinical correlation and possibly\nfurther imaging if symptoms persist or worsen."
          },
          "2.25.121043577106706659500131090336553354531": {
            "report_text": "JACQUELINE BISHOP, M.D.\n\n\n\n********Preliminary Report********\n\n\n \nACC#  Date Time  Exam\n\n\n800257423 Aug 14 2025 07:05PM IMG154 XR ABDOMEN AP 1 VIEW\nEXAMINATION: Abdominal X-ray\n\nFINDINGS:\nAbdominal radiograph reveals diffuse gaseous distention within the\ncolon with fecal loading, mild stool retention. No signs of free air\nor obstruction. Bony structures normal. Soft tissues unremarkable.\n\n\nIMPRESSION:\nConstipation with fecal impaction suggested. No acute obstruction or\nperforation seen.\nRequested By: Wood,Joseph S. M.D.\n\nDictated By: Jacqueline Bishop, M.D. on Aug 14 2025 07:05PM\n\nPending review by: Luis Small, M.D.\n \n\n\n \n\n\n \n800257423^UK^ZB"
          },
          "2.25.203807271003801336156822674911037502972": {
            "report_text": "EXAMINATION: Coronary X-ray angiography\nFINDINGS:\nX-ray angiographic images depict multi-vessel coronary artery disease\nwith 50-60% stenosis of proximal right coronary artery and 40%\nirregular plaques in the circumflex artery. No occlusive thrombi\nvisualized. Ventricular motion preserved.\n\n\nIMPRESSION:\nModerate multi-vessel coronary artery disease. Clinical correlation\nand medical management advised.\nDictated by: Luis Small Interpreter, M.D."
          }
        },
        "columnTypes": []
      },
      "sql": "SELECT message_control_id, report_text FROM %TABLE_PLACEHOLDER% WHERE message_control_id IN ('2.25.61155004502365997902991606362324782931', '2.25.204398915138762988851874407954207601533', '2.25.121043577106706659500131090336553354531', '2.25.203807271003801336156822674911037502972')",
      "id": "report_text"
    }
  ]
}
